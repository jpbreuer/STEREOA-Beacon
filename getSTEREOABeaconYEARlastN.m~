% function [jds,vm,Nm,Tm,Bxm,Bym,Bzm,rm,HEEQlonm,HEEQlatm,HEElonm,HEElatm] = getSTEREOABeaconlastN(jd0,NN)
% %
jds=NaN;vm=NaN;Nm=NaN;Tm=NaN;Bxm=NaN;Bym=NaN;Bzm=NaN;rm=NaN;
HEEQlonm=NaN;HEEQlatm=NaN;HEElonm=NaN;HEElatm=NaN;

jd0 = 6.3472e+03;%jd2000(300);
NN = 5;

if jd0 == 0
    [yyy,mm,dd] = ymd(datetime('now','TimeZone','UTC'));
    [h,m,s]=hms(datetime('now','TimeZone','UTC'));
    utct = h + m/60;
    jd0 = jd2000_new(yyy,mm,dd,utct);
    %     doy = day(datetime('now','TimeZone','UTC'),'dayofyear');
end

[startyear,startmonth,startday,starttime]=jd2date(jd0-NN/24);
[endyear,endmonth,endday,endtime]=jd2date(jd0);

totaldays = datenum(datetime([endyear,endmonth,endday]))-datenum(datetime([startyear,startmonth,startday]));
d = dir('./data/daily-mat/*.mat');

x=[];
for yyyy = startyear:endyear
    x = [x;load(sprintf('./data/StereoA%s.mat',num2str(yyyy)))];   % read/concatenate into x
end
fieldNames = fieldnames(x);
for pp = 1:length(fieldNames)
    combineddata.(fieldNames{pp}) = vertcat(x.(fieldNames{pp}));
end
jds = combineddata.jd2000;
vm = combineddata.vm;
Nm = combineddata.Nm;
Tm = combineddata.Tm;
Bxm = combineddata.Bxm;
Bym = combineddata.Bym;
Bzm = combineddata.Bzm;
rm = combineddata.rm;
HEEQlatm = combineddata.HEEQlatm;
HEEQlonm = combineddata.HEEQlonm;
HEElatm = combineddata.HEElatm;
HEElonm = combineddata.HEElonm;

% for yyyy = startyear:endyear  
%     filnam = sprintf('./data/StereoA%s.mat',yyyy);
%     eval(['load ' filnam ';']);
%     
%     ii = find(jds >= jd0-NN/24 & jds <= jd0);
%     if yyyy == startyear;
%         jds = jds(ii);
%         vm = vm(ii);
%         Nm = Nm(ii);
%         Tm = Tm(ii);
%         Bxm = Bxm(ii);
%         Bym = Bym(ii);
%         Bzm = Bzm(ii);
%         rm = rm(1);
%         HEEQlonm = HEEQlonm(1);
%         HEEQlatm = HEEQlatm(1);
%         HEElonm = HEElonm(1);
%         HEElatm = HEElatm(1);
%     else
%         jds = [jds jdIMF(ii)'];
%         vm = [vm v(ii)'];
%         Nm = [Nm N(ii)'];
%         Tm = [Tm T(ii)'];
%         Bxm = [Bxm Bx(ii)'];
%         Bym = [Bym By(ii)'];
%         Bzm = [Bzm Bz(ii)'];
%         rm = [rm r(ii)'];
%         HEEQlonm = [HEEQlonm HEEQlon(ii)'];
%         HEEQlatm = [HEEQlatm HEEQlat(ii)'];
%         HEElonm = [HEElonm HEElon(ii)'];
%         HEElatm = [HEEQlonm HEElat(ii)'];
%     end
end